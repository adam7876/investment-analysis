{% extends "base.html" %}

{% block title %}首頁 - 美股投資分析系統{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12 text-center mb-5">
        <h1 class="display-4 fw-bold mb-3">
            <i class="fas fa-chart-line text-primary me-3"></i>
            美股投資分析系統
        </h1>
        <p class="lead text-muted">
            運用AI和數據分析，打造您的專業投資決策平台
        </p>
    </div>
</div>

<div class="row mb-5">
    <div class="col-md-4 mb-4">
        <div class="card h-100 text-center">
            <div class="card-body">
                <div class="mb-3">
                    <i class="fas fa-globe fa-3x text-primary"></i>
                </div>
                <h5 class="card-title">第一層：總經環境</h5>
                <p class="card-text">
                    分析市場情緒、經濟指標和總體環境，
                    為投資決策提供宏觀視角。
                </p>
                <div class="mt-auto">
                    <span class="badge bg-success">✓ 已完成</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-4 mb-4">
        <div class="card h-100 text-center">
            <div class="card-body">
                <div class="mb-3">
                    <i class="fas fa-newspaper fa-3x text-warning"></i>
                </div>
                <h5 class="card-title">第二層：事件選股</h5>
                <p class="card-text">
                    追蹤財經事件、新聞情緒和產業動態，
                    發掘投資機會和風險。
                </p>
                <div class="mt-auto">
                    <span class="badge bg-warning">🚧 開發中</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-4 mb-4">
        <div class="card h-100 text-center">
            <div class="card-body">
                <div class="mb-3">
                    <i class="fas fa-chart-bar fa-3x text-info"></i>
                </div>
                <h5 class="card-title">第三層：技術確認</h5>
                <p class="card-text">
                    結合基本面和技術分析，
                    確認進出場時機和風險管理。
                </p>
                <div class="mt-auto">
                    <span class="badge bg-secondary">⏳ 規劃中</span>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mb-5">
    <div class="col-12">
        <div class="card">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">
                    <i class="fas fa-rocket me-2"></i>
                    快速開始
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6 class="fw-bold mb-3">
                            <i class="fas fa-play-circle text-success me-2"></i>
                            立即體驗
                        </h6>
                        <p class="mb-3">
                            點擊下方按鈕開始您的第一次市場分析，
                            系統將自動收集最新的總經數據並提供投資建議。
                        </p>
                        <div class="d-grid gap-2 d-md-flex">
                            <a href="/dashboard" class="btn btn-primary btn-lg">
                                <i class="fas fa-tachometer-alt me-2"></i>
                                前往儀表板
                            </a>
                            <button class="btn btn-outline-primary btn-lg" onclick="quickAnalysis()">
                                <i class="fas fa-bolt me-2"></i>
                                快速分析
                            </button>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h6 class="fw-bold mb-3">
                            <i class="fas fa-info-circle text-info me-2"></i>
                            系統特色
                        </h6>
                        <ul class="list-unstyled">
                            <li class="mb-2">
                                <i class="fas fa-check text-success me-2"></i>
                                實時市場情緒分析
                            </li>
                            <li class="mb-2">
                                <i class="fas fa-check text-success me-2"></i>
                                聯準會官方經濟數據
                            </li>
                            <li class="mb-2">
                                <i class="fas fa-check text-success me-2"></i>
                                智能投資建議
                            </li>
                            <li class="mb-2">
                                <i class="fas fa-check text-success me-2"></i>
                                風險等級評估
                            </li>
                            <li class="mb-2">
                                <i class="fas fa-check text-success me-2"></i>
                                現代化Web介面
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-chart-pie me-2"></i>
                    系統狀態
                </h5>
            </div>
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-md-3 mb-3">
                        <div class="metric-card">
                            <h6 class="mb-1">數據源</h6>
                            <h3 class="mb-0">3</h3>
                            <small>個活躍來源</small>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="metric-card">
                            <h6 class="mb-1">分析層級</h6>
                            <h3 class="mb-0">1/3</h3>
                            <small>已完成</small>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="metric-card">
                            <h6 class="mb-1">系統狀態</h6>
                            <h3 class="mb-0">
                                <i class="fas fa-check-circle"></i>
                            </h3>
                            <small>運行正常</small>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="metric-card">
                            <h6 class="mb-1">最後更新</h6>
                            <h3 class="mb-0" id="last-update">--</h3>
                            <small>分鐘前</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 載入動畫 -->
<div id="loading-spinner" class="loading-spinner text-center">
    <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">載入中...</span>
    </div>
    <p class="mt-2">正在進行快速分析...</p>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // 快速分析功能
    async function quickAnalysis() {
        try {
            toggleLoading(true);
            showNotification('開始進行快速市場分析...', 'info');
            
            const response = await fetch('/api/layer1/summary');
            const result = await response.json();
            
            if (result.success) {
                showNotification('快速分析完成！正在跳轉到儀表板...', 'success');
                setTimeout(() => {
                    window.location.href = '/dashboard';
                }, 1500);
            } else {
                showNotification('分析失敗：' + result.error, 'error');
            }
        } catch (error) {
            showNotification('系統錯誤：' + error.message, 'error');
        } finally {
            toggleLoading(false);
        }
    }
    
    // 更新最後更新時間
    function updateLastUpdateTime() {
        // 這裡可以從API獲取實際的最後更新時間
        // 暫時顯示隨機時間作為示例
        const minutes = Math.floor(Math.random() * 60) + 1;
        document.getElementById('last-update').textContent = minutes;
    }
    
    // 頁面載入時執行
    document.addEventListener('DOMContentLoaded', function() {
        updateLastUpdateTime();
        
        // 每分鐘更新一次時間
        setInterval(updateLastUpdateTime, 60000);
    });
</script>
{% endblock %} 